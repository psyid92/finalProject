<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mileage">


<!-- 마일리지  -->


<!-- 마일리지 테스트를 위한 쿼리

insert into orders values(orders_seq.nextVal, '주문중');
insert into jumun(jumun_num, jumun_pay, jumun_addr, jumun_tel, jumun_memo, m1_num, orders_num)
values(jumun_seq.nextVal, 21000, '주소 주소 주소 주소를 적어주세요', '01011234456','빨리 갖다 주세요, 치킨무 많이', 41, 2);

 -->



<!-- 마일리지 삽입 -->
<insert id="insertMileage" parameterType="com.sp.mileage.Mileage">
	insert into mileage(mil_num, mil_point, mil_state, m1_num, jumun_num) values(mil_seq.nextVal, #{mil_point}, #{mil_state}, #{m1_num}, #{jumun_num})
</insert>

<!-- 마일리지 적립 상태 수정 -->
<update id="updateMileageState" parameterType="com.sp.mileage.Mileage">
	update mileage set mil_state = #{mil_state} where mil_num=#{mil_num}
</update>



<!-- 회원 마일리지 변경 -->
<update id="addMemberMileage">
	update memberMileage set mm_Point = mm_Point + #{mm_point} where m1_num = #{m1_num}
</update>

<update id="minusMemberMileage">
	update memberMileage set mm_Point = mm_Point - #{mm_point} where m1_num = #{m1_num}
</update>



<!-- 마일리지 보기 -->
<select id="getMemberMileage" parameterType="String" resultType="Integer">
	select mm_point from memberMileage where m1_num=(select m1_num from member1 where m1_email=#{m1_email})
</select>


<!-- 적립 마일리지 내역 삭제 -->
<delete id="deleteMileage">
	delete mileage where mil_num=#{mil_num}
</delete>

<!-- 사용 마일리지 삭제 -->
<delete id="deleteUseMileage">
	delete usemileage where use_num=#{use_num}
</delete>

</mapper>